(()=>{"use strict";const e=class{constructor(e,t,o=""){this.title=e,this.description=t,this.dueDate=o}getTitle(){return this.title}setTitle(e){return this.title=e}getDescription(){return this.description}setDescription(e){return this.description=e}getDueDate(){if(""==this.dueDate){let e=new Date,t=e.getDate(),o=e.getMonth()+1,n=e.getFullYear();return this.dueDate=`${n}-${o}-${t}`}{let e=this.dueDate.split("-"),t=new Date(e[0],e[1],e[2]),o=t.getDate(),n=t.getMonth(),s=t.getFullYear();return this.dueDate=`${s}-${n}-${o}`}}setDate(e){return this.dueDate=e}},t=class{constructor(e){this.name=e,this.todos=[]}getName(){return this.name}setName(e){return this.name=e}getTodos(){return this.todos}getTodo(e){return this.todos.find((t=>t.title===e.title))}addTodo(e){this.todos.find((t=>t.title===e.title))||this.todos.push(e)}deleteTodo(e){return this.todos=this.todos.filter((t=>t.title!==e))}};function o(e){const t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function n(e){const t=new Date;return e.getDate()<t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function s(e,t){const o=new Date;return e.getDate()>o.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()&&e.getDate()<=t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function d(e){let t=e.split("-"),o=t[2],n=t[1],s=t[0];return new Date(s,n-1,o)}function i(){let e=new Date,t=e.getDate(),o=e.getMonth(),n=e.getFullYear(),s=function(e,t){return new Date(t,e,0).getDate()}(o,n),d=t+6,i=o,a=n;return d>s&&(d=1,i+=1,13===i&&(i=1,a+=1)),new Date(a,i,d)}const a=new class{constructor(){this.projects=[],this.projects.push(new t("Today")),this.projects.push(new t("This Week")),this.projects.push(new t("This Month"))}getProjects(){return this.projects}getProject(e){return this.projects.find((t=>t.name===e))}addProject(e){this.projects.find((t=>t.name===e.name))||this.projects.push(e)}sortTodos(){let e=this.getProject("Today"),t=this.getProject("This Month"),a=this.getProject("This Week");!function(e,t,a){for(let l=0;l<e.getTodos().length;l++){let c=e.getTodos()[l],r=d(c.getDueDate()),u=i();o(r)||n(r)?(a.addTodo(c),e.deleteTodo(c.title)):s(r,u)&&(t.addTodo(c),e.deleteTodo(c.title))}}(t,a,e),function(e,t,a){for(let l=0;l<t.getTodos().length;l++){let c=t.getTodos()[l],r=d(c.getDueDate()),u=i();o(r)||n(r)?(a.addTodo(c),t.deleteTodo(c.title)):s(r,u)||(e.addTodo(c),t.deleteTodo(c.title))}}(t,a,e),function(e,t,a){for(let l=0;l<a.getTodos().length;l++){let c=a.getTodos()[l],r=d(c.getDueDate()),u=i();s(r,u)&&(t.addTodo(c),a.deleteTodo(c.title)),o(r)||s(r,u)||n(r)||(e.addTodo(c),a.deleteTodo(c.title))}}(t,a,e)}},l=a.getProject("Today"),c=a.getProject("This Week"),r=a.getProject("This Month"),u=document.querySelector(".main-board"),g=document.querySelector(".button-box"),h=document.querySelector(".todo-form"),m=document.querySelector(".fa-circle-xmark"),p=document.querySelector(".create-todo-btn");function D(){h.classList.toggle("invisible");let e=h.elements.item(0),t=h.elements.item(1),o=h.elements.item(2),n=h.elements.item(3);h.classList.contains("invisible")||t.focus(),e.value="today",t.value="",o.value="",n.value=""}function v(){u.textContent="";let e=["#FAEDCB","#C9E4DE","#C6DEF1","#D8CDF0","#F2C6DE","#F7D9C4"];for(let t=0;t<a.getProjects().length;t++){let o=T(a.getProjects()[t]),n=Math.floor(4*Math.random())+1,s=e[n];o.childNodes[0].style.backgroundColor=s,e.splice(n,1),u.appendChild(o)}}function T(e){const t=document.createElement("div");t.classList.add("project-box");const o=document.createElement("p");o.classList.add("project-header"),o.textContent=e.name;const n=e.getTodos();if(t.appendChild(o),0!=n.length){const o=document.createElement("div");o.classList.add("todo-box"),o.classList.add("visible");for(let t=0;t<n.length;t++){let s=f(n[t],e);s.style.backgroundColor=t%2==1?"#e4e4e4":"white",o.appendChild(s)}t.appendChild(o),t.addEventListener("click",(()=>{o.classList.toggle("visible")}))}return t}function f(e,t){const o=document.createElement("div");o.classList.add("todo");const n=document.createElement("input");n.classList.add("todo-checkbox"),n.setAttribute("type","checkbox");const s=document.createElement("p");s.classList.add("todo-title"),s.textContent=e.title;const d=document.createElement("p");d.classList.add("todo-date"),d.textContent=e.getDueDate();const i=document.createElement("div");i.classList.add("check-title-date"),i.append(n,s,d);const a=document.createElement("p");return a.classList.add("todo-description"),a.textContent=e.description,n.addEventListener("change",(n=>{n.target.checked&&(o.classList.add("disappear"),setTimeout((()=>{t.deleteTodo(e.title),o.remove()}),1e3))})),o.addEventListener("dblclick",(e=>{e.target!=s&&e.target!=n&&(a.classList.add("visible"),a.contentEditable=!0,a.focus(),E(a))})),a.addEventListener("click",(()=>{a.contentEditable=!0,a.focus(),E(a)})),a.addEventListener("keypress",(t=>{"Enter"===t.key&&(e.setDescription(a.textContent),a.blur(),a.contentEditable=!1)})),o.addEventListener("click",(e=>{e.target!=s&&e.target!=n&&""!=a.textContent&&e.target!=a&&a.classList.toggle("visible")})),s.addEventListener("click",(()=>{s.contentEditable=!0,a.contentEditable=!1,s.focus(),E(s)})),s.addEventListener("keypress",(t=>{"Enter"===t.key&&(e.setTitle(s.textContent),s.blur(),s.contentEditable=!1)})),o.append(i,a),o}function E(e){let t,o;document.createRange&&(t=document.createRange(),t.selectNodeContents(e),t.collapse(!1),o=window.getSelection(),o.removeAllRanges(),o.addRange(t))}g.addEventListener("click",D),m.addEventListener("click",D),p.addEventListener("click",(t=>{t.preventDefault();let o=h.elements.item(0),n=h.elements.item(1),s=h.elements.item(2),d=h.elements.item(3);if(""===d.value){const t=new e(n.value,s.value);"today"===o.value?l.addTodo(t):"this week"===o.value?c.addTodo(t):"this month"===o.value&&r.addTodo(t)}else{const t=new e(n.value,s.value,d.value);"today"===o.value?l.addTodo(t):"this week"===o.value?c.addTodo(t):"this month"===o.value&&r.addTodo(t)}o.value="today",n.value="",s.value="",d.value="",h.classList.add("invisible"),a.sortTodos(),v()})),v()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OEYsTUFBTzdGLEVBQVk2RixNQUFPNUYsRUFBUTRGLE9BQzNDLFVBQWxCTCxFQUFRSyxNQUNWbEIsRUFBVzVDLFFBQVFrSCxHQUNRLGNBQWxCekQsRUFBUUssTUFDakJqQixFQUFVN0MsUUFBUWtILEdBQ1MsZUFBbEJ6RCxFQUFRSyxPQUNqQmhCLEVBQVc5QyxRQUFRa0gsRUFFdkIsQ0FFQXpELEVBQVFLLE1BQVEsUUFDaEI5RixFQUFNOEYsTUFBUSxHQUNkN0YsRUFBWTZGLE1BQVEsR0FDcEI1RixFQUFRNEYsTUFBUSxHQUNoQlgsRUFBU0ksVUFBVXlCLElBQUksYUFHdkIxRCxFQUFTUSxZQUNUaUMsR0FBYyxJQXVCaEJBLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvbGlzdC8uL3NyYy90b2RvLmpzIiwid2VicGFjazovL3RvZG9saXN0Ly4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QvLi9zcmMvVG9kb3MuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgVG9kbyB7XHJcbiAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlID0gXCJcIikge1xyXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5kdWVEYXRlID0gZHVlRGF0ZTtcclxuICB9XHJcblxyXG4gIGdldFRpdGxlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMudGl0bGU7XHJcbiAgfVxyXG5cclxuICBzZXRUaXRsZShuZXdUaXRsZSkge1xyXG4gICAgcmV0dXJuICh0aGlzLnRpdGxlID0gbmV3VGl0bGUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0RGVzY3JpcHRpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kZXNjcmlwdGlvbjtcclxuICB9XHJcblxyXG4gIHNldERlc2NyaXB0aW9uKG5ld0Rlc2NyaXB0aW9uKSB7XHJcbiAgICByZXR1cm4gKHRoaXMuZGVzY3JpcHRpb24gPSBuZXdEZXNjcmlwdGlvbik7XHJcbiAgfVxyXG5cclxuICBnZXREdWVEYXRlKCkge1xyXG4gICAgaWYgKHRoaXMuZHVlRGF0ZSA9PSBcIlwiKSB7XHJcbiAgICAgIGxldCBuZXdEYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgbGV0IGRheSA9IG5ld0RhdGUuZ2V0RGF0ZSgpO1xyXG4gICAgICBsZXQgbW9udGggPSBuZXdEYXRlLmdldE1vbnRoKCkgKyAxO1xyXG4gICAgICBsZXQgeWVhciA9IG5ld0RhdGUuZ2V0RnVsbFllYXIoKTtcclxuXHJcbiAgICAgIHJldHVybiAodGhpcy5kdWVEYXRlID0gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgZGF0ZUFycmF5ID0gdGhpcy5kdWVEYXRlLnNwbGl0KFwiLVwiKTtcclxuICAgICAgbGV0IG5ld0RhdGUgPSBuZXcgRGF0ZShkYXRlQXJyYXlbMF0sIGRhdGVBcnJheVsxXSwgZGF0ZUFycmF5WzJdKTtcclxuICAgICAgbGV0IGRheSA9IG5ld0RhdGUuZ2V0RGF0ZSgpO1xyXG4gICAgICBsZXQgbW9udGggPSBuZXdEYXRlLmdldE1vbnRoKCkgO1xyXG4gICAgICBsZXQgeWVhciA9IG5ld0RhdGUuZ2V0RnVsbFllYXIoKTtcclxuXHJcbiAgICAgIHJldHVybiAodGhpcy5kdWVEYXRlID0gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXREYXRlKG5ld0RhdGUpIHtcclxuICAgIHJldHVybiAodGhpcy5kdWVEYXRlID0gbmV3RGF0ZSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUb2RvO1xyXG4iLCJjbGFzcyBQcm9qZWN0IHtcclxuICBjb25zdHJ1Y3RvcihuYW1lKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy50b2RvcyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgZ2V0TmFtZSgpIHtcclxuICAgIHJldHVybiB0aGlzLm5hbWU7XHJcbiAgfVxyXG5cclxuICBzZXROYW1lKG5ld05hbWUpIHtcclxuICAgIHJldHVybiAodGhpcy5uYW1lID0gbmV3TmFtZSk7XHJcbiAgfVxyXG5cclxuICBnZXRUb2RvcygpIHtcclxuICAgIHJldHVybiB0aGlzLnRvZG9zO1xyXG4gIH1cclxuXHJcbiAgZ2V0VG9kbyhjaG9zZW5Ub2RvT2JqZWN0KSB7XHJcbiAgICByZXR1cm4gdGhpcy50b2Rvcy5maW5kKCh0b2RvKSA9PiB0b2RvLnRpdGxlID09PSBjaG9zZW5Ub2RvT2JqZWN0LnRpdGxlKTtcclxuICB9XHJcblxyXG4gIGFkZFRvZG8odG9kb09iamVjdCkge1xyXG4gICAgaWYgKHRoaXMudG9kb3MuZmluZCgodG9kbykgPT4gdG9kby50aXRsZSA9PT0gdG9kb09iamVjdC50aXRsZSkpIHJldHVybjtcclxuICAgIHRoaXMudG9kb3MucHVzaCh0b2RvT2JqZWN0KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZVRvZG8odG9kb1RpdGxlVG9CZURlbGV0ZWQpIHtcclxuICAgIHJldHVybiAodGhpcy50b2RvcyA9IHRoaXMudG9kb3MuZmlsdGVyKFxyXG4gICAgICAodG9kbykgPT4gdG9kby50aXRsZSAhPT0gdG9kb1RpdGxlVG9CZURlbGV0ZWRcclxuICAgICkpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUHJvamVjdDtcclxuIiwiaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xyXG5cclxuY2xhc3MgVG9kb3Mge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5wcm9qZWN0cyA9IFtdO1xyXG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ldyBQcm9qZWN0KFwiVG9kYXlcIikpO1xyXG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ldyBQcm9qZWN0KFwiVGhpcyBXZWVrXCIpKTtcclxuICAgIHRoaXMucHJvamVjdHMucHVzaChuZXcgUHJvamVjdChcIlRoaXMgTW9udGhcIikpO1xyXG4gIH1cclxuXHJcbiAgZ2V0UHJvamVjdHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9qZWN0cztcclxuICB9XHJcblxyXG4gIGdldFByb2plY3QocHJvamVjdE5hbWUpIHtcclxuICAgIHJldHVybiB0aGlzLnByb2plY3RzLmZpbmQoKHByb2opID0+IHByb2oubmFtZSA9PT0gcHJvamVjdE5hbWUpO1xyXG4gIH1cclxuXHJcbiAgYWRkUHJvamVjdChuZXdQcm9qZWN0T2JqZWN0KSB7XHJcbiAgICBpZiAodGhpcy5wcm9qZWN0cy5maW5kKChwcm9qKSA9PiBwcm9qLm5hbWUgPT09IG5ld1Byb2plY3RPYmplY3QubmFtZSkpXHJcbiAgICAgIHJldHVybjtcclxuICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0T2JqZWN0KTtcclxuICB9XHJcblxyXG4gIHNvcnRUb2RvcygpIHtcclxuICAgIGxldCB0b2RheVByb2plY3QgPSB0aGlzLmdldFByb2plY3QoXCJUb2RheVwiKTtcclxuICAgIGxldCBtb250aFByb2plY3QgPSB0aGlzLmdldFByb2plY3QoXCJUaGlzIE1vbnRoXCIpO1xyXG4gICAgbGV0IHdlZWtQcm9qZWN0ID0gdGhpcy5nZXRQcm9qZWN0KFwiVGhpcyBXZWVrXCIpO1xyXG5cclxuICAgIC8vIEVhY2ggZnVuY3Rpb24gc29ydHMgYSBwYXJ0aWN1bGFyIFByb2plY3QgYW5kIG1vdmVzIGFuZCBkZWxldGVzIGEgVG9kbyBhY2NvcmRpbmcgdG8gZHVlIGRhdGVcclxuICAgIHNvcnRNb250aFByb2plY3QobW9udGhQcm9qZWN0LCB3ZWVrUHJvamVjdCwgdG9kYXlQcm9qZWN0KTtcclxuICAgIHNvcnRXZWVrUHJvamVjdChtb250aFByb2plY3QsIHdlZWtQcm9qZWN0LCB0b2RheVByb2plY3QpO1xyXG4gICAgc29ydFRvZGF5UHJvamVjdChtb250aFByb2plY3QsIHdlZWtQcm9qZWN0LCB0b2RheVByb2plY3QpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gU09SVCBGVU5DVElPTlNcclxuXHJcbmZ1bmN0aW9uIHNvcnRNb250aFByb2plY3QobW9udGhQcm9qLCB3ZWVrUHJvaiwgdG9kYXlQcm9qKSB7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb250aFByb2ouZ2V0VG9kb3MoKS5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IHRvZG8gPSBtb250aFByb2ouZ2V0VG9kb3MoKVtpXTtcclxuICAgIGxldCB0b2RvRHVlRGF0ZSA9IHRvZG8uZ2V0RHVlRGF0ZSgpO1xyXG5cclxuICAgIGxldCByZWZvcm1hdHRlZER1ZURhdGUgPSByZWZvcm1hdER1ZURhdGUodG9kb0R1ZURhdGUpO1xyXG5cclxuICAgIGxldCBmdWxsRW5kT2ZXZWVrRGF0ZSA9IGdldEVuZE9mV2Vla0RhdGUoKTtcclxuXHJcbiAgICBpZiAoaXNUb2RheShyZWZvcm1hdHRlZER1ZURhdGUpIHx8IGJlZm9yZVRvZGF5KHJlZm9ybWF0dGVkRHVlRGF0ZSkpIHtcclxuICAgICAgdG9kYXlQcm9qLmFkZFRvZG8odG9kbyk7XHJcbiAgICAgIG1vbnRoUHJvai5kZWxldGVUb2RvKHRvZG8udGl0bGUpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzV2VlayhyZWZvcm1hdHRlZER1ZURhdGUsIGZ1bGxFbmRPZldlZWtEYXRlKSkge1xyXG4gICAgICB3ZWVrUHJvai5hZGRUb2RvKHRvZG8pO1xyXG4gICAgICBtb250aFByb2ouZGVsZXRlVG9kbyh0b2RvLnRpdGxlKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNvcnRXZWVrUHJvamVjdChtb250aFByb2osIHdlZWtQcm9qLCB0b2RheVByb2opIHtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHdlZWtQcm9qLmdldFRvZG9zKCkubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCB0b2RvID0gd2Vla1Byb2ouZ2V0VG9kb3MoKVtpXTtcclxuICAgIGxldCB0b2RvRHVlRGF0ZSA9IHRvZG8uZ2V0RHVlRGF0ZSgpO1xyXG4gICAgbGV0IHJlZm9ybWF0dGVkRHVlRGF0ZSA9IHJlZm9ybWF0RHVlRGF0ZSh0b2RvRHVlRGF0ZSk7XHJcbiAgICBsZXQgZnVsbEVuZE9mV2Vla0RhdGUgPSBnZXRFbmRPZldlZWtEYXRlKCk7XHJcblxyXG4gICAgaWYgKGlzVG9kYXkocmVmb3JtYXR0ZWREdWVEYXRlKSB8fCBiZWZvcmVUb2RheShyZWZvcm1hdHRlZER1ZURhdGUpKSB7XHJcbiAgICAgIHRvZGF5UHJvai5hZGRUb2RvKHRvZG8pO1xyXG4gICAgICB3ZWVrUHJvai5kZWxldGVUb2RvKHRvZG8udGl0bGUpO1xyXG4gICAgfSBlbHNlIGlmICghdGhpc1dlZWsocmVmb3JtYXR0ZWREdWVEYXRlLCBmdWxsRW5kT2ZXZWVrRGF0ZSkpIHtcclxuICAgICAgbW9udGhQcm9qLmFkZFRvZG8odG9kbyk7XHJcbiAgICAgIHdlZWtQcm9qLmRlbGV0ZVRvZG8odG9kby50aXRsZSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzb3J0VG9kYXlQcm9qZWN0KG1vbnRoUHJvaiwgd2Vla1Byb2osIHRvZGF5UHJvaikge1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG9kYXlQcm9qLmdldFRvZG9zKCkubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCB0b2RvID0gdG9kYXlQcm9qLmdldFRvZG9zKClbaV07XHJcbiAgICBsZXQgdG9kb0R1ZURhdGUgPSB0b2RvLmdldER1ZURhdGUoKTtcclxuICAgIGxldCByZWZvcm1hdHRlZER1ZURhdGUgPSByZWZvcm1hdER1ZURhdGUodG9kb0R1ZURhdGUpO1xyXG4gICAgbGV0IGZ1bGxFbmRPZldlZWtEYXRlID0gZ2V0RW5kT2ZXZWVrRGF0ZSgpO1xyXG5cclxuICAgIGlmICh0aGlzV2VlayhyZWZvcm1hdHRlZER1ZURhdGUsIGZ1bGxFbmRPZldlZWtEYXRlKSkge1xyXG4gICAgICB3ZWVrUHJvai5hZGRUb2RvKHRvZG8pO1xyXG4gICAgICB0b2RheVByb2ouZGVsZXRlVG9kbyh0b2RvLnRpdGxlKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoXHJcbiAgICAgICFpc1RvZGF5KHJlZm9ybWF0dGVkRHVlRGF0ZSkgJiZcclxuICAgICAgIXRoaXNXZWVrKHJlZm9ybWF0dGVkRHVlRGF0ZSwgZnVsbEVuZE9mV2Vla0RhdGUpICYmXHJcbiAgICAgICFiZWZvcmVUb2RheShyZWZvcm1hdHRlZER1ZURhdGUpXHJcbiAgICApIHtcclxuICAgICAgbW9udGhQcm9qLmFkZFRvZG8odG9kbyk7XHJcbiAgICAgIHRvZGF5UHJvai5kZWxldGVUb2RvKHRvZG8udGl0bGUpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gREFURSBDT01QQVJJU09OIENIRUNLSU5HIEZVTkNUSU9OU1xyXG5cclxuZnVuY3Rpb24gaXNUb2RheShkdWVEYXRlKSB7XHJcbiAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG5cclxuICBjb25zdCBpc1NhbWVEYXRlID1cclxuICAgIGR1ZURhdGUuZ2V0RGF0ZSgpID09PSB0b2RheS5nZXREYXRlKCkgJiZcclxuICAgIGR1ZURhdGUuZ2V0TW9udGgoKSA9PT0gdG9kYXkuZ2V0TW9udGgoKSAmJlxyXG4gICAgZHVlRGF0ZS5nZXRGdWxsWWVhcigpID09PSB0b2RheS5nZXRGdWxsWWVhcigpO1xyXG4gIHJldHVybiBpc1NhbWVEYXRlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBiZWZvcmVUb2RheShkdWVEYXRlKSB7XHJcbiAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG4gIGNvbnN0IGlzYmVmb3JlVG9kYXkgPVxyXG4gICAgZHVlRGF0ZS5nZXREYXRlKCkgPCB0b2RheS5nZXREYXRlKCkgJiZcclxuICAgIGR1ZURhdGUuZ2V0TW9udGgoKSA9PT0gdG9kYXkuZ2V0TW9udGgoKSAmJlxyXG4gICAgZHVlRGF0ZS5nZXRGdWxsWWVhcigpID09PSB0b2RheS5nZXRGdWxsWWVhcigpO1xyXG5cclxuICByZXR1cm4gaXNiZWZvcmVUb2RheTtcclxufVxyXG5cclxuZnVuY3Rpb24gdGhpc1dlZWsoZHVlRGF0ZSwgd2Vla0RhdGUpIHtcclxuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XHJcbiAgY29uc3QgaXNXaXRoaW5XZWVrRW5kID1cclxuICAgIGR1ZURhdGUuZ2V0RGF0ZSgpID4gdG9kYXkuZ2V0RGF0ZSgpICYmXHJcbiAgICBkdWVEYXRlLmdldE1vbnRoKCkgPT09IHdlZWtEYXRlLmdldE1vbnRoKCkgJiZcclxuICAgIGR1ZURhdGUuZ2V0RnVsbFllYXIoKSA9PT0gd2Vla0RhdGUuZ2V0RnVsbFllYXIoKSAmJlxyXG4gICAgZHVlRGF0ZS5nZXREYXRlKCkgPD0gd2Vla0RhdGUuZ2V0RGF0ZSgpICYmXHJcbiAgICBkdWVEYXRlLmdldE1vbnRoKCkgPT09IHdlZWtEYXRlLmdldE1vbnRoKCkgJiZcclxuICAgIGR1ZURhdGUuZ2V0RnVsbFllYXIoKSA9PT0gd2Vla0RhdGUuZ2V0RnVsbFllYXIoKTtcclxuXHJcbiAgcmV0dXJuIGlzV2l0aGluV2Vla0VuZDtcclxufVxyXG5cclxuLy8gVVRJTCBGVU5DVElPTlNcclxuXHJcbmZ1bmN0aW9uIHJlZm9ybWF0RHVlRGF0ZShkdWVEYXRlKSB7XHJcbiAgbGV0IGR1ZURhdGVBcnJheSA9IGR1ZURhdGUuc3BsaXQoXCItXCIpO1xyXG4gIGxldCB0b2RvRGF5ID0gZHVlRGF0ZUFycmF5WzJdO1xyXG4gIGxldCB0b2RvTW9udGggPSBkdWVEYXRlQXJyYXlbMV07XHJcbiAgbGV0IHRvZG9ZZWFyID0gZHVlRGF0ZUFycmF5WzBdO1xyXG4gIHJldHVybiBuZXcgRGF0ZSh0b2RvWWVhciwgdG9kb01vbnRoIC0gMSwgdG9kb0RheSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEVuZE9mV2Vla0RhdGUoKSB7XHJcbiAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICBsZXQgZGF5ID0gdG9kYXkuZ2V0RGF0ZSgpO1xyXG4gIGxldCBtb250aCA9IHRvZGF5LmdldE1vbnRoKCk7XHJcbiAgbGV0IHllYXIgPSB0b2RheS5nZXRGdWxsWWVhcigpO1xyXG5cclxuICBsZXQgbnVtYmVyT2ZEYXlzSW5Nb250aCA9IGRheXNJbk1vbnRoKG1vbnRoLCB5ZWFyKTtcclxuICBsZXQgZW5kT2ZXZWVrRGF5ID0gZGF5ICsgNjtcclxuICBsZXQgZW5kT2ZNb250aCA9IG1vbnRoO1xyXG4gIGxldCBlbmRPZlllYXIgPSB5ZWFyO1xyXG5cclxuICBpZiAoZW5kT2ZXZWVrRGF5ID4gbnVtYmVyT2ZEYXlzSW5Nb250aCkge1xyXG4gICAgZW5kT2ZXZWVrRGF5ID0gMTtcclxuICAgIGVuZE9mTW9udGggKz0gMTtcclxuXHJcbiAgICAvLyByZXNldCBtb250aCB0byBKYW51YXJ5IGFuZCBhZGQgMSB0byB5ZWFyXHJcbiAgICBpZiAoZW5kT2ZNb250aCA9PT0gMTMpIHtcclxuICAgICAgZW5kT2ZNb250aCA9IDE7XHJcbiAgICAgIGVuZE9mWWVhciArPSAxO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIG5ldyBEYXRlKGVuZE9mWWVhciwgZW5kT2ZNb250aCwgZW5kT2ZXZWVrRGF5KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGF5c0luTW9udGgobW9udGgsIHllYXIpIHtcclxuICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIDApLmdldERhdGUoKTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVG9kb3M7XHJcbiIsImltcG9ydCBUb2RvIGZyb20gXCIuL3RvZG9cIjtcclxuaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xyXG5pbXBvcnQgVG9kb3MgZnJvbSBcIi4vVG9kb3NcIjtcclxuXHJcbi8vIFRFU1RcclxuLypsZXQgdGVzdFRvZG8gPSBuZXcgVG9kbyhcIlRvZG8gMVwiLCBcIm5ldyB0ZXN0IGZvciB0b2RvIGJveCAxXCIpO1xyXG5sZXQgdGVzdFRvZG8yID0gbmV3IFRvZG8oXCJUb2RvIDJcIiwgXCJuZXcgdGVzdCBmb3IgdG9kbyBib3ggMlwiKTtcclxubGV0IHRlc3RUb2RvMyA9IG5ldyBUb2RvKFwiVG9kbyAzXCIsIFwibmV3IHRlc3QgZm9yIHRvZG8gYm94IDNcIik7IFxyXG5sZXQgZGF0ZVNvcnRUZXN0ID0gbmV3IFRvZG8oXCJUb2RvIDVcIiwgXCJuZXcgdGVzdCBmb3IgZGF0ZSBzb3J0aW5nXCIsIFwiMTUtMS0yMDI1XCIpO1xyXG5sZXQgbW9udGhUZXN0ID0gbmV3IFRvZG8oXCJNb250aCB0ZXN0XCIsIFwidGVzdGluZyBtb250aCBzb3J0XCIsIFwiMjYtMS0yMDI1XCIpO1xyXG5cclxuXHJcblxyXG50b2RheVRvZG9zLmFkZFRvZG8odGVzdFRvZG8pO1xyXG50b2RheVRvZG9zLmFkZFRvZG8odGVzdFRvZG8yKTtcclxudG9kYXlUb2Rvcy5hZGRUb2RvKHRlc3RUb2RvMyk7XHJcbnRvZGF5VG9kb3MuYWRkVG9kbyhkYXRlU29ydFRlc3QpO1xyXG5cclxubW9udGhUb2Rvcy5hZGRUb2RvKG1vbnRoVGVzdCk7XHJcbiovXHJcblxyXG5jb25zdCBhbGxUb2RvcyA9IG5ldyBUb2RvcygpO1xyXG5cclxuY29uc3QgdG9kYXlUb2RvcyA9IGFsbFRvZG9zLmdldFByb2plY3QoXCJUb2RheVwiKTtcclxuY29uc3Qgd2Vla1RvZG9zID0gYWxsVG9kb3MuZ2V0UHJvamVjdChcIlRoaXMgV2Vla1wiKTtcclxuY29uc3QgbW9udGhUb2RvcyA9IGFsbFRvZG9zLmdldFByb2plY3QoXCJUaGlzIE1vbnRoXCIpO1xyXG5cclxuLy9hbGxUb2Rvcy5zb3J0VG9kb3MoKTtcclxuXHJcbi8vIERPTSBFTEVNRU5UU1xyXG5cclxuY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1ib2FyZFwiKTtcclxuXHJcbmNvbnN0IGFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnV0dG9uLWJveFwiKTtcclxuY29uc3QgdG9kb0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tZm9ybVwiKTtcclxuY29uc3QgY2xvc2VUb2RvRm9ybUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmEtY2lyY2xlLXhtYXJrXCIpO1xyXG5jb25zdCB0b2RvU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jcmVhdGUtdG9kby1idG5cIik7XHJcblxyXG4vLyBMaXN0ZW5lcnNcclxuXHJcbmFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VGb3JtQW5kUmVzZXQpO1xyXG5cclxuY2xvc2VUb2RvRm9ybUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VGb3JtQW5kUmVzZXQpO1xyXG5cclxudG9kb1N1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgbGV0IHByb2plY3QgPSB0b2RvRm9ybS5lbGVtZW50cy5pdGVtKDApO1xyXG4gIGxldCB0aXRsZSA9IHRvZG9Gb3JtLmVsZW1lbnRzLml0ZW0oMSk7XHJcbiAgbGV0IGRlc2NyaXB0aW9uID0gdG9kb0Zvcm0uZWxlbWVudHMuaXRlbSgyKTtcclxuICBsZXQgZHVlRGF0ZSA9IHRvZG9Gb3JtLmVsZW1lbnRzLml0ZW0oMyk7XHJcblxyXG4gIGlmIChkdWVEYXRlLnZhbHVlID09PSBcIlwiKSB7XHJcbiAgICBjb25zdCBuZXdUb2RvID0gbmV3IFRvZG8odGl0bGUudmFsdWUsIGRlc2NyaXB0aW9uLnZhbHVlKTtcclxuICAgIGlmIChwcm9qZWN0LnZhbHVlID09PSBcInRvZGF5XCIpIHtcclxuICAgICAgdG9kYXlUb2Rvcy5hZGRUb2RvKG5ld1RvZG8pO1xyXG4gICAgfSBlbHNlIGlmIChwcm9qZWN0LnZhbHVlID09PSBcInRoaXMgd2Vla1wiKSB7XHJcbiAgICAgIHdlZWtUb2Rvcy5hZGRUb2RvKG5ld1RvZG8pO1xyXG4gICAgfSBlbHNlIGlmIChwcm9qZWN0LnZhbHVlID09PSBcInRoaXMgbW9udGhcIikge1xyXG4gICAgICBtb250aFRvZG9zLmFkZFRvZG8obmV3VG9kbyk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnN0IG5ld1RvZG8gPSBuZXcgVG9kbyh0aXRsZS52YWx1ZSwgZGVzY3JpcHRpb24udmFsdWUsIGR1ZURhdGUudmFsdWUpO1xyXG4gICAgaWYgKHByb2plY3QudmFsdWUgPT09IFwidG9kYXlcIikge1xyXG4gICAgICB0b2RheVRvZG9zLmFkZFRvZG8obmV3VG9kbyk7XHJcbiAgICB9IGVsc2UgaWYgKHByb2plY3QudmFsdWUgPT09IFwidGhpcyB3ZWVrXCIpIHtcclxuICAgICAgd2Vla1RvZG9zLmFkZFRvZG8obmV3VG9kbyk7XHJcbiAgICB9IGVsc2UgaWYgKHByb2plY3QudmFsdWUgPT09IFwidGhpcyBtb250aFwiKSB7XHJcbiAgICAgIG1vbnRoVG9kb3MuYWRkVG9kbyhuZXdUb2RvKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByb2plY3QudmFsdWUgPSBcInRvZGF5XCI7XHJcbiAgdGl0bGUudmFsdWUgPSBcIlwiO1xyXG4gIGRlc2NyaXB0aW9uLnZhbHVlID0gXCJcIjtcclxuICBkdWVEYXRlLnZhbHVlID0gXCJcIjtcclxuICB0b2RvRm9ybS5jbGFzc0xpc3QuYWRkKFwiaW52aXNpYmxlXCIpO1xyXG5cclxuICAvLyBTb3J0aW5nIHRvZG9zIG9ubHkgaGFwcGVucyBpbiBkZWZhdWx0IFByb2plY3RzKFwiVG9kYXlcIiwgXCJUaGlzIFdlZWtcIiwgXCJUaGlzIE1vbnRoXCIpXHJcbiAgYWxsVG9kb3Muc29ydFRvZG9zKCk7XHJcbiAgc2hvd1Byb2plY3RzKCk7XHJcbn0pO1xyXG5cclxuLy8gTGlzdGVuZXIgRnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBjbG9zZUZvcm1BbmRSZXNldCgpIHtcclxuICB0b2RvRm9ybS5jbGFzc0xpc3QudG9nZ2xlKFwiaW52aXNpYmxlXCIpO1xyXG4gIGxldCBwcm9qZWN0ID0gdG9kb0Zvcm0uZWxlbWVudHMuaXRlbSgwKTtcclxuICBsZXQgdGl0bGUgPSB0b2RvRm9ybS5lbGVtZW50cy5pdGVtKDEpO1xyXG4gIGxldCBkZXNjcmlwdGlvbiA9IHRvZG9Gb3JtLmVsZW1lbnRzLml0ZW0oMik7XHJcbiAgbGV0IGR1ZURhdGUgPSB0b2RvRm9ybS5lbGVtZW50cy5pdGVtKDMpO1xyXG5cclxuICBpZiAoIXRvZG9Gb3JtLmNsYXNzTGlzdC5jb250YWlucyhcImludmlzaWJsZVwiKSkge1xyXG4gICAgdGl0bGUuZm9jdXMoKTtcclxuICB9XHJcblxyXG4gIHByb2plY3QudmFsdWUgPSBcInRvZGF5XCI7XHJcbiAgdGl0bGUudmFsdWUgPSBcIlwiO1xyXG4gIGRlc2NyaXB0aW9uLnZhbHVlID0gXCJcIjtcclxuICBkdWVEYXRlLnZhbHVlID0gXCJcIjtcclxufVxyXG5cclxuLy8gRE9NIExvYWRlcnNcclxuc2hvd1Byb2plY3RzKCk7XHJcblxyXG5mdW5jdGlvbiBzaG93UHJvamVjdHMoKSB7XHJcbiAgbWFpbi50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgLy8gdG8gZW5zdXJlIG5vIGNvbG9yIHJlcGVhdHNcclxuICBsZXQgY29sb3JBcnJheSA9IFtcclxuICAgIFwiI0ZBRURDQlwiLFxyXG4gICAgXCIjQzlFNERFXCIsXHJcbiAgICBcIiNDNkRFRjFcIixcclxuICAgIFwiI0Q4Q0RGMFwiLFxyXG4gICAgXCIjRjJDNkRFXCIsXHJcbiAgICBcIiNGN0Q5QzRcIixcclxuICBdO1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbFRvZG9zLmdldFByb2plY3RzKCkubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBwcm9qZWN0ID0gYWxsVG9kb3MuZ2V0UHJvamVjdHMoKVtpXTtcclxuXHJcbiAgICBsZXQgcHJvamVjdEJveCA9IGNyZWF0ZVByb2plY3RCb3gocHJvamVjdCk7XHJcblxyXG4gICAgLy8gQ29sb3IgZWFjaCBwcm9qZWN0IGhlYWRlciBkaWZmZXJlbnRseVxyXG5cclxuICAgIGxldCBiZ0NvbG9ySW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoNSAtIDEpKSArIDE7XHJcbiAgICBsZXQgYmdDb2xvciA9IGNvbG9yQXJyYXlbYmdDb2xvckluZGV4XTtcclxuICAgIGxldCBwcm9qZWN0SGVhZGVyID0gcHJvamVjdEJveC5jaGlsZE5vZGVzWzBdO1xyXG5cclxuICAgIHByb2plY3RIZWFkZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYmdDb2xvcjtcclxuXHJcbiAgICAvLyBSZW1vdmUgY29sb3IgZnJvbSBhcnJheSBzbyBpdCBjYW4ndCBiZSBwaWNrZWQgYWdhaW5cclxuICAgIGNvbG9yQXJyYXkuc3BsaWNlKGJnQ29sb3JJbmRleCwgMSk7XHJcblxyXG4gICAgbWFpbi5hcHBlbmRDaGlsZChwcm9qZWN0Qm94KTtcclxuICB9XHJcbn1cclxuXHJcbi8vIERPTSBDcmVhdGlvbiBGdW5jdGlvbnNcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVByb2plY3RCb3gocHJvamVjdE9iamVjdCkge1xyXG4gIGNvbnN0IHByb2plY3RCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gIHByb2plY3RCb3guY2xhc3NMaXN0LmFkZChcInByb2plY3QtYm94XCIpO1xyXG5cclxuICBjb25zdCBwcm9qZWN0SGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgcHJvamVjdEhlYWRlci5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC1oZWFkZXJcIik7XHJcbiAgcHJvamVjdEhlYWRlci50ZXh0Q29udGVudCA9IHByb2plY3RPYmplY3QubmFtZTtcclxuXHJcbiAgY29uc3QgcHJvamVjdFRvZG9zID0gcHJvamVjdE9iamVjdC5nZXRUb2RvcygpO1xyXG5cclxuICBwcm9qZWN0Qm94LmFwcGVuZENoaWxkKHByb2plY3RIZWFkZXIpO1xyXG5cclxuICBpZiAocHJvamVjdFRvZG9zLmxlbmd0aCAhPSAwKSB7XHJcbiAgICBjb25zdCB0b2RvQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIHRvZG9Cb3guY2xhc3NMaXN0LmFkZChcInRvZG8tYm94XCIpO1xyXG4gICAgdG9kb0JveC5jbGFzc0xpc3QuYWRkKFwidmlzaWJsZVwiKTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2plY3RUb2Rvcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsZXQgdG9kbyA9IHByb2plY3RUb2Rvc1tpXTtcclxuICAgICAgbGV0IHRvZG9FbCA9IGNyZWF0ZVRvZG9Cb3godG9kbywgcHJvamVjdE9iamVjdCk7XHJcblxyXG4gICAgICBpZiAoaSAlIDIgPT0gMSkge1xyXG4gICAgICAgIHRvZG9FbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNlNGU0ZTRcIjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0b2RvRWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0b2RvQm94LmFwcGVuZENoaWxkKHRvZG9FbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvamVjdEJveC5hcHBlbmRDaGlsZCh0b2RvQm94KTtcclxuXHJcbiAgICAvLyBMaXN0ZW5lcnNcclxuXHJcbiAgICBwcm9qZWN0Qm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRvZG9Cb3guY2xhc3NMaXN0LnRvZ2dsZShcInZpc2libGVcIik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJldHVybiBwcm9qZWN0Qm94O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVUb2RvQm94KHRvZG9PYmplY3QsIHByb2plY3RPYmplY3QpIHtcclxuICBjb25zdCB0b2RvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICB0b2RvLmNsYXNzTGlzdC5hZGQoXCJ0b2RvXCIpO1xyXG5cclxuICBjb25zdCBjaGVja0JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICBjaGVja0JveC5jbGFzc0xpc3QuYWRkKFwidG9kby1jaGVja2JveFwiKTtcclxuICBjaGVja0JveC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiY2hlY2tib3hcIik7XHJcblxyXG4gIGNvbnN0IHRvZG9UaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gIHRvZG9UaXRsZS5jbGFzc0xpc3QuYWRkKFwidG9kby10aXRsZVwiKTtcclxuICB0b2RvVGl0bGUudGV4dENvbnRlbnQgPSB0b2RvT2JqZWN0LnRpdGxlO1xyXG5cclxuICBjb25zdCB0b2RvRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gIHRvZG9EYXRlLmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWRhdGVcIik7XHJcbiAgdG9kb0RhdGUudGV4dENvbnRlbnQgPSB0b2RvT2JqZWN0LmdldER1ZURhdGUoKTtcclxuXHJcbiAgY29uc3QgY2hlY2tUaXRsZURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gIGNoZWNrVGl0bGVEYXRlLmNsYXNzTGlzdC5hZGQoXCJjaGVjay10aXRsZS1kYXRlXCIpO1xyXG5cclxuICBjaGVja1RpdGxlRGF0ZS5hcHBlbmQoY2hlY2tCb3gsIHRvZG9UaXRsZSwgdG9kb0RhdGUpO1xyXG5cclxuICBjb25zdCB0b2RvRGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICB0b2RvRGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInRvZG8tZGVzY3JpcHRpb25cIik7XHJcbiAgdG9kb0Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdG9kb09iamVjdC5kZXNjcmlwdGlvbjtcclxuXHJcbiAgLy8gTGlzdGVuZXJzXHJcblxyXG4gIGNoZWNrQm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHtcclxuICAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7XHJcbiAgICAgIHRvZG8uY2xhc3NMaXN0LmFkZChcImRpc2FwcGVhclwiKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgcHJvamVjdE9iamVjdC5kZWxldGVUb2RvKHRvZG9PYmplY3QudGl0bGUpO1xyXG4gICAgICAgIHRvZG8ucmVtb3ZlKCk7XHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICB0b2RvLmFkZEV2ZW50TGlzdGVuZXIoXCJkYmxjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgaWYgKGUudGFyZ2V0ICE9IHRvZG9UaXRsZSAmJiBlLnRhcmdldCAhPSBjaGVja0JveCkge1xyXG4gICAgICB0b2RvRGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInZpc2libGVcIik7XHJcbiAgICAgIHRvZG9EZXNjcmlwdGlvbi5jb250ZW50RWRpdGFibGUgPSB0cnVlO1xyXG4gICAgICB0b2RvRGVzY3JpcHRpb24uZm9jdXMoKTtcclxuICAgICAgc2V0VG9FbmRPZkVkaXRhYmxlKHRvZG9EZXNjcmlwdGlvbik7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHRvZG9EZXNjcmlwdGlvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgdG9kb0Rlc2NyaXB0aW9uLmNvbnRlbnRFZGl0YWJsZSA9IHRydWU7XHJcbiAgICB0b2RvRGVzY3JpcHRpb24uZm9jdXMoKTtcclxuICAgIHNldFRvRW5kT2ZFZGl0YWJsZSh0b2RvRGVzY3JpcHRpb24pO1xyXG4gIH0pO1xyXG5cclxuICB0b2RvRGVzY3JpcHRpb24uYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICB0b2RvT2JqZWN0LnNldERlc2NyaXB0aW9uKHRvZG9EZXNjcmlwdGlvbi50ZXh0Q29udGVudCk7XHJcbiAgICAgIHRvZG9EZXNjcmlwdGlvbi5ibHVyKCk7XHJcbiAgICAgIHRvZG9EZXNjcmlwdGlvbi5jb250ZW50RWRpdGFibGUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgdG9kby5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIGlmIChcclxuICAgICAgZS50YXJnZXQgIT0gdG9kb1RpdGxlICYmXHJcbiAgICAgIGUudGFyZ2V0ICE9IGNoZWNrQm94ICYmXHJcbiAgICAgIHRvZG9EZXNjcmlwdGlvbi50ZXh0Q29udGVudCAhPSBcIlwiICYmXHJcbiAgICAgIGUudGFyZ2V0ICE9IHRvZG9EZXNjcmlwdGlvblxyXG4gICAgKSB7XHJcbiAgICAgIHRvZG9EZXNjcmlwdGlvbi5jbGFzc0xpc3QudG9nZ2xlKFwidmlzaWJsZVwiKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgdG9kb1RpdGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICB0b2RvVGl0bGUuY29udGVudEVkaXRhYmxlID0gdHJ1ZTtcclxuICAgIHRvZG9EZXNjcmlwdGlvbi5jb250ZW50RWRpdGFibGUgPSBmYWxzZTtcclxuICAgIHRvZG9UaXRsZS5mb2N1cygpO1xyXG4gICAgc2V0VG9FbmRPZkVkaXRhYmxlKHRvZG9UaXRsZSk7XHJcbiAgfSk7XHJcblxyXG4gIHRvZG9UaXRsZS5hZGRFdmVudExpc3RlbmVyKFwia2V5cHJlc3NcIiwgKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XHJcbiAgICAgIHRvZG9PYmplY3Quc2V0VGl0bGUodG9kb1RpdGxlLnRleHRDb250ZW50KTtcclxuICAgICAgdG9kb1RpdGxlLmJsdXIoKTtcclxuICAgICAgdG9kb1RpdGxlLmNvbnRlbnRFZGl0YWJsZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICB0b2RvLmFwcGVuZChjaGVja1RpdGxlRGF0ZSwgdG9kb0Rlc2NyaXB0aW9uKTtcclxuXHJcbiAgcmV0dXJuIHRvZG87XHJcbn1cclxuXHJcbi8vIFVUSUxTXHJcblxyXG5mdW5jdGlvbiBzZXRUb0VuZE9mRWRpdGFibGUoZWRpdGFibGVFbGVtZW50KSB7XHJcbiAgbGV0IHJhbmdlO1xyXG4gIGxldCBzZWxlY3Rpb247XHJcbiAgaWYgKGRvY3VtZW50LmNyZWF0ZVJhbmdlKSB7XHJcbiAgICByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XHJcbiAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZWRpdGFibGVFbGVtZW50KTtcclxuICAgIHJhbmdlLmNvbGxhcHNlKGZhbHNlKTtcclxuICAgIHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcclxuICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTtcclxuICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwidGhpcyIsImdldFRpdGxlIiwic2V0VGl0bGUiLCJuZXdUaXRsZSIsImdldERlc2NyaXB0aW9uIiwic2V0RGVzY3JpcHRpb24iLCJuZXdEZXNjcmlwdGlvbiIsImdldER1ZURhdGUiLCJuZXdEYXRlIiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwiZGF0ZUFycmF5Iiwic3BsaXQiLCJzZXREYXRlIiwibmFtZSIsInRvZG9zIiwiZ2V0TmFtZSIsInNldE5hbWUiLCJuZXdOYW1lIiwiZ2V0VG9kb3MiLCJnZXRUb2RvIiwiY2hvc2VuVG9kb09iamVjdCIsImZpbmQiLCJ0b2RvIiwiYWRkVG9kbyIsInRvZG9PYmplY3QiLCJwdXNoIiwiZGVsZXRlVG9kbyIsInRvZG9UaXRsZVRvQmVEZWxldGVkIiwiZmlsdGVyIiwiaXNUb2RheSIsInRvZGF5IiwiYmVmb3JlVG9kYXkiLCJ0aGlzV2VlayIsIndlZWtEYXRlIiwicmVmb3JtYXREdWVEYXRlIiwiZHVlRGF0ZUFycmF5IiwidG9kb0RheSIsInRvZG9Nb250aCIsInRvZG9ZZWFyIiwiZ2V0RW5kT2ZXZWVrRGF0ZSIsIm51bWJlck9mRGF5c0luTW9udGgiLCJkYXlzSW5Nb250aCIsImVuZE9mV2Vla0RheSIsImVuZE9mTW9udGgiLCJlbmRPZlllYXIiLCJhbGxUb2RvcyIsInByb2plY3RzIiwiZ2V0UHJvamVjdHMiLCJnZXRQcm9qZWN0IiwicHJvamVjdE5hbWUiLCJwcm9qIiwiYWRkUHJvamVjdCIsIm5ld1Byb2plY3RPYmplY3QiLCJzb3J0VG9kb3MiLCJ0b2RheVByb2plY3QiLCJtb250aFByb2plY3QiLCJ3ZWVrUHJvamVjdCIsIm1vbnRoUHJvaiIsIndlZWtQcm9qIiwidG9kYXlQcm9qIiwiaSIsImxlbmd0aCIsInJlZm9ybWF0dGVkRHVlRGF0ZSIsImZ1bGxFbmRPZldlZWtEYXRlIiwic29ydE1vbnRoUHJvamVjdCIsInNvcnRXZWVrUHJvamVjdCIsInNvcnRUb2RheVByb2plY3QiLCJ0b2RheVRvZG9zIiwid2Vla1RvZG9zIiwibW9udGhUb2RvcyIsIm1haW4iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRCdG4iLCJ0b2RvRm9ybSIsImNsb3NlVG9kb0Zvcm1CdG4iLCJ0b2RvU3VibWl0QnRuIiwiY2xvc2VGb3JtQW5kUmVzZXQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJwcm9qZWN0IiwiZWxlbWVudHMiLCJpdGVtIiwiY29udGFpbnMiLCJmb2N1cyIsInZhbHVlIiwic2hvd1Byb2plY3RzIiwidGV4dENvbnRlbnQiLCJjb2xvckFycmF5IiwicHJvamVjdEJveCIsImNyZWF0ZVByb2plY3RCb3giLCJiZ0NvbG9ySW5kZXgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJiZ0NvbG9yIiwiY2hpbGROb2RlcyIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwic3BsaWNlIiwiYXBwZW5kQ2hpbGQiLCJwcm9qZWN0T2JqZWN0IiwiY3JlYXRlRWxlbWVudCIsImFkZCIsInByb2plY3RIZWFkZXIiLCJwcm9qZWN0VG9kb3MiLCJ0b2RvQm94IiwidG9kb0VsIiwiY3JlYXRlVG9kb0JveCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0JveCIsInNldEF0dHJpYnV0ZSIsInRvZG9UaXRsZSIsInRvZG9EYXRlIiwiY2hlY2tUaXRsZURhdGUiLCJhcHBlbmQiLCJ0b2RvRGVzY3JpcHRpb24iLCJlIiwidGFyZ2V0IiwiY2hlY2tlZCIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJjb250ZW50RWRpdGFibGUiLCJzZXRUb0VuZE9mRWRpdGFibGUiLCJrZXkiLCJibHVyIiwiZWRpdGFibGVFbGVtZW50IiwicmFuZ2UiLCJzZWxlY3Rpb24iLCJjcmVhdGVSYW5nZSIsInNlbGVjdE5vZGVDb250ZW50cyIsImNvbGxhcHNlIiwid2luZG93IiwiZ2V0U2VsZWN0aW9uIiwicmVtb3ZlQWxsUmFuZ2VzIiwiYWRkUmFuZ2UiLCJwcmV2ZW50RGVmYXVsdCIsIm5ld1RvZG8iXSwic291cmNlUm9vdCI6IiJ9